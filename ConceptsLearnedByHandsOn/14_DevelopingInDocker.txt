Lets try to develop something in docker

We have a node app that has two routes defined, very simple one
It has two dependencies:
    mongo-db --> database app will use
    mongo-express --> interface for this DB

We don't want these dependencies inside our local system, we will use docker containers for it 

mongo-db image:

    this image has a port that comes with it, based on dockerhub details, port = 27017
    we will bind our own localhost to the same port, so we need to do little port binding here

    we will run this container in detached mode
    we will give this container a custom name

    Based on this file in dockerhub data for this image:

    Example compose.yaml for mongo:
        services:
        mongo:
            image: mongo
            restart: always
            environment:
            MONGO_INITDB_ROOT_USERNAME: root
            MONGO_INITDB_ROOT_PASSWORD: example

    we need to pass these variables in environment compulsorily.

    we will directly run the container, image will be pulled automatically

    we need to pass many parameters in our docker run command, so we will break the line, 
    and on each line, we will pass individual parameters, for better readability.

        In Windows CMD (use ^ at line breaks)
        In PowerShell (use backtick ` at line breaks)
        In Linux/macOS (bash/zsh) (use \ at line breaks)

C:\Users>docker network ls
NETWORK ID     NAME          DRIVER    SCOPE
0b45d9e34444   bridge        bridge    local
707aa03f4bc9   express-net   bridge    local
16fb85c0b9da   host          host      local
ad3af3ddd8d4   mongo-net     bridge    local
7518ddf84cc2   none          null      local

C:\Users>docker run -d ^
More? -p27017:27017 ^
More? --name mongo-container ^
More? --network mongoDB-net ^
More? -e MONGO_INITDB_ROOT_USERNAME=admin ^
More? -e MONGO_INITDB_ROOT_PASSWORD=qwerty ^
More? mongo
Unable to find image 'mongo:latest' locally
latest: Pulling from library/mongo
a89cc6fb1ead: Pull complete
88373bcb58c1: Pull complete
7230971360e4: Pull complete
dcec2d403c4e: Pull complete
20043066d3d5: Pull complete
6dc84fd2f3ac: Pull complete
8a63055b2837: Pull complete
1732f2a4d259: Pull complete
Digest: sha256:7245ffb851d149dbfac67397caf91bae4974d899972f9fd1d8985fc6eea3c13d
Status: Downloaded newer image for mongo:latest
3199c47e092b6db235952262abc4851aab62b8d5c65e709207dd94264543ccc0

C:\Users>docker ps
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                                             NAMES
3199c47e092b   mongo     "docker-entrypoint.s…"   11 minutes ago   Up 10 minutes   0.0.0.0:27017->27017/tcp, [::]:27017->27017/tcp   mongo-container

Similarly, pull the mongo-express image and run with similar envs

Its almost same command, just search mongo-express official docker image on docker hub


RUN both mongoDB and mongoexpress on same network

docker run -d ^
More?   -p 8081:8081 ^
More?   --name mongo-express-container ^
More?   --network mongoDB-net ^
More?   -e ME_CONFIG_MONGODB_ADMINUSERNAME=admin ^
More?   -e ME_CONFIG_MONGODB_ADMINPASSWORD=qwerty ^
More?   -e ME_CONFIG_MONGODB_SERVER=mongo-container ^
More?   -e ME_CONFIG_BASICAUTH=false ^
More?   mongo-express
8d276a85883b9610e16ab8cc3e9a1a7a7b517eb36a0753f97f175b7f13cc1147


After successfull Run, our setup looks something like this

-> Docker desktop: ConceptsLearnedByHandsOn\Images\DockerDesktopAfterSetup.png
-> MongoDB using Mongo-express -> ConceptsLearnedByHandsOn\Images\MongoDBInterfaceUsingMongoExpress.png

On mongoDB, via mongo-express interface, create 
new db -> docker-db
new collection -> users 
new document ->   
{
    "_id": "69370615855eaf42418251cb",
    "email": "ad@gmail.com",
    "username": "Atharva Deshmukh",
    "password": "qwerty"
}

Now, app code:

//////////////////////////////////////////////////////////////////////
const express = require("express");
const app = express();
const { MongoClient } = require("mongodb");

const PORT = 5050;
app.use(express.urlencoded({ extended: true }));
app.use(express.json()); // for JSON body
app.use(express.static("public"));

// MongoDB running in Docker, connect from host
const MONGO_URL = "mongodb://admin:qwerty@localhost:27017/?authSource=admin";
const DB_NAME = "docker-db";
const COLLECTION_NAME = "users";

let client;

// Connect once and reuse
async function connectToMongo() {
  if (!client || !client.isConnected?.()) {
    client = new MongoClient(MONGO_URL, { useUnifiedTopology: true });
    await client.connect();
    console.log("Connected successfully to MongoDB");
  }
  return client.db(DB_NAME);
}

// GET all users
app.get("/getUsers", async (req, res) => {
  try {
    const db = await connectToMongo();
    const users = await db.collection(COLLECTION_NAME).find({}).toArray();
    res.json(users);
  } catch (err) {
    console.error("Error fetching users:", err);
    res.status(500).json({ error: "Database error" });
  }
});

// POST new user
app.post("/addUser", async (req, res) => {
  try {
    const userObj = req.body;
    const db = await connectToMongo();
    const result = await db.collection(COLLECTION_NAME).insertOne(userObj);
    console.log("Inserted:", result.insertedId);
    res.json({ success: true, insertedId: result.insertedId });
  } catch (err) {
    console.error("Error inserting user:", err);
    res.status(500).json({ error: "Database error" });
  }
});

app.listen(PORT, () => {
  console.log(`Server running on port ${PORT}`);
});

//////////////////////////////////////////////////////////////////////

Hit node app.js and start the app
Node modules are all fetched from node modules

But, the DB we are connecting, its not installed on the local, its in a docker container, 
mongo-container.

When we run: http://localhost:5050/getUsers

Response:
[
  {
    "_id": "69370615855eaf42418251cb",
    "email": "ad@gmail.com",
    "username": "Atharva Deshmukh",
    "password": "qwerty"
  }
]

REFER -> ConceptsLearnedByHandsOn\Images\AppResponse.png

How could we fetch data in mongo db, although mongo db is not installed in our local?

-> Its through the docker container, container is hosted in docker.

See const MONGO_URL = "mongodb://admin:qwerty@localhost:27017/?authSource=admin";

From localhost:27017 → host port bound to the MongoDB container port.

In Docker, we ran the container using: docker run -p 27017:27017 mongo
The -p flag binds the container’s port 27017 to your host’s port 27017.

That’s why our host Node.js app can connect to the container: 
the traffic goes through the host port → Docker container → MongoDB.

The port mapping is why your app can reach the database. 

////////////////////////////////////////////////////////////////
ARCHITECTURE

┌─────────────────────────────────────────────────────────────┐
│                    Docker Container Setup                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │              Docker Network: mongoDB-net            │   │
│  │                                                     │   │
│  │   ┌──────────────┐         ┌──────────────┐        │   │
│  │   │   MongoDB    │         │ Mongo-Express│        │   │
│  │   │              │         │              │        │   │
│  │   │  Port: 27017 ├─────────► Port: 8081   │        │   │
│  │   │  User: admin │         │  Web UI Auth:│        │   │
│  │   │  Pass: qwerty│         │  admin/pass  │        │   │
│  │   └──────┬───────┘         └──────┬───────┘        │   │
│  └──────────┼─────────────────────────┼────────────────┘   │
│             │                         │                    │
│    ┌────────▼─────┐         ┌────────▼─────┐              │
│    │ Host:27017   │         │ Host:8081    │              │
│    │ (localhost)  │         │ (localhost)  │              │
│    └──────────────┘         └──────────────┘              │
│                                                             │
└─────────────────────────────────────────────────────────────┘

Flow: User → localhost:8081 → Mongo-Express → MongoDB
Credentials: admin/qwerty (MongoDB) + admin/pass (Web UI).

Mongo DB is running inside docker container, not in our local

////////////////////////////////////////////////////////////////